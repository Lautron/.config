#!/sbin/sh

project=$(cat ~/.config/scripts/.projects | fzf | xargs)
name=$2
breaknum=1
workset=50
break_duration=10
speak_interval=10

function work(){
  local total=$1
  for ((mins=$((total-speak_interval)); mins > 0; mins=$((mins-speak_interval)))); do
    sleep "$((mins*60))" && espeak "$speak_interval minutes have passed" &
  done
  toggl start -o "$project" $name
  timer "$1m" "Work"
  toggl stop
  timer "$((break_duration))m" "Break #$breaknum"
  breaknum=$((breaknum+1))
}

for ((a=1; a <= $1; a++)); do
  work $workset
done

